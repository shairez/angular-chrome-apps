angular.module("chromeApps",[]),angular.module("chromeApps").factory("chromeApps.services.syncFilesystem",["$q",function(a){function b(b){var c=a.defer(),d=new FileReader;return d.onerror=function(a){console.log("error",a),c.reject(a)},d.onloadend=function(a){c.resolve(a.target.result)},d.readAsText(b),c.promise}function c(b){var c=a.defer();return chrome.syncFileSystem.requestFileSystem(function(a){a.root.getFile(b,{create:!0},function(a){c.resolve(a)})}),c.promise}function d(b){var c=a.defer();return b.file(function(a){c.resolve(a)}),c.promise}function e(b,c){var d=a.defer();return b.createWriter(function(a){c=c||"",c=c.toString(),a.onerror=function(a){d.reject(a)},a.onwriteend=function(){d.resolve("write complete"),a.onwriteend=null,a.write(new Blob([c]),{type:"text/plain"})},a.truncate(0)}),d.promise}return{gettingTextFile:function(a){return c(a).then(function(a){return d(a).then(function(a){return b(a)})})},savingTextFile:function(a,b){return c(a).then(function(a){return e(a,b)})}}}]);